{% comment %}
  Renders a product card
  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - media_size: {String} Size of the product image card. Values are "square" and "portrait". Default is "square" (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - add_image_padding: {Boolean} Enables padding on the image to space out the grid
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_image_outline: {Boolean} Show card outline. Default: true (optional)
  - show_rating: {Boolean} Show the product rating. Default: false
  Usage:
  {% render 'product-card', show_vendor: section.settings.show_vendor %}
{% endcomment %}
{%- liquid
  assign ratio = 1
  if card_product.featured_media and media_aspect_ratio == 'portrait'
    assign ratio = 0.8
  elsif card_product.featured_media and media_aspect_ratio == 'adapt'
    assign ratio = card_product.featured_media.aspect_ratio
  endif
  if ratio == 0 or ratio == null
    assign ratio = 1
  endif
-%}
<div class='card-wrapper wbproduct-container'>
  <div
    class='
      card gradient {{ settings.card_text_alignment }}
      card--{{ settings.card_style }}
      {% if card_product.featured_media %} card--media{% else %} card--text{% endif %}
      {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
      {% if extend_height %} card--extend-height{% endif %}
      {% if card_product.featured_media == nil and settings.card_style == 'card' %} ratio{% endif %}
    '
    style='--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;'
  >
    <div
      class='card__inner  wbimgblock {% if settings.card_style == 'standard' %}color-{{ settings.card_color_scheme }} gradient{% endif %}{% if settings.card_style != 'standard' or card_product.featured_media or settings.card_style == 'standard' %} ratio {% endif %} '
      style='--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;'
    >
      {%- if card_product.featured_media -%}
        {% comment %} Variants Wise Product Change {% endcomment %}
        <div id='webipro-{{ section.id }}-{{ card_product.id }}' class='card__media'>
          {%- assign media = card_product.selected_or_first_available_variant.featured_media -%}
          <div class='product__media-item' data-media-id='{{ section.id }}-{{ card_product.id }}-{{ media.id }}'>
            <a
              href='{{ card_product.url | append: '?variant=' | append: card_product.selected_or_first_available_variant.id | default: '#' }}'
              title='{{ card_product.title | escape }}'
              class='media media--transparent media--{{ media_size }} media--hover-effect'
              {% if media_size == 'adapt' and card_product.featured_media %}
                style='padding-bottom: {{ 1 | divided_by: featured_media_aspect_ratio | times: 100 }}%;'
              {% endif %}
            >
              <img
                class='img-fluid mx-auto lazyload'
                srcset='
                  {%- if card_product.featured_media.width >= 165 -%}{{ card_product.featured_media | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if card_product.featured_media.width >= 360 -%}{{ card_product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
                  {% if card_product.featured_media.width >= 493 %}{{ card_product.featured_media | image_url: width: 493 }} 493w,{% endif %}
                  {% if card_product.featured_media.width >= 600 %}{{ card_product.featured_media | image_url: width: 600 }} 600w,{% endif %}
                  {% if card_product.featured_media.width >= 713 %}{{ card_product.featured_media | image_url: width: 713 }} 713w,{% endif %}
                  {% if card_product.featured_media.width >= 823 %}{{ card_product.featured_media | image_url: width: 823 }} 823w,{% endif %}
                  {% if card_product.featured_media.width >= 992 %}{{ card_product.featured_media | image_url: width: 992 }} 992w,{% endif %}
                  {% if card_product.featured_media.width >= 1100 %}{{ card_product.featured_media | image_url: width: 1100 }} 1100w,{% endif %}
                  {% if card_product.featured_media.width >= 1206 %}{{ card_product.featured_media | image_url: width: 1206 }} 1206w,{% endif %}
                  {% if card_product.featured_media.width >= 1346 %}{{ card_product.featured_media | image_url: width: 1346 }} 1346w,{% endif %}
                  {% if card_product.featured_media.width >= 1426 %}{{ card_product.featured_media | image_url: width: 1426 }} 1426w,{% endif %}
                  {% if card_product.featured_media.width >= 1646 %}{{ card_product.featured_media | image_url: width: 1646 }} 1646w,{% endif %}
                  {% if card_product.featured_media.width >= 1946 %}{{ card_product.featured_media | image_url: width: 1946 }} 1946w,{% endif %}
                  {{ card_product.featured_media | image_url }} {{ card_product.featured_media.width }}w
                '
                src='{{ card_product.featured_media | image_url: width: 370 }} 370w'
                sizes='(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 992px) calc((100vw - 130px) / 4), (min-width: 768px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)'
                loading='lazy'
                width='{{ card_product.featured_media.width }}'
                height='{{ card_product.featured_media.height }}'
                alt='{{ card_product.featured_media.alt | escape }}'
              >
              {%- if card_product.media[1] != null and show_secondary_image -%}
                <img
                  srcset='
                    {%- if card_product.media[1].width >= 165 -%}{{ card_product.media[1] | image_url: width: 165 }} 165w,{%- endif -%}
                    {%- if card_product.media[1].width >= 360 -%}{{ card_product.media[1] | image_url: width: 360 }} 360w,{%- endif -%}
                    {% if card_product.media[1].width >= 493 %}{{ card_product.media[1] | image_url: width: 493 }} 493w,{% endif %}
                    {% if card_product.media[1].width >= 600 %}{{ card_product.media[1] | image_url: width: 600 }} 600w,{% endif %}
                    {% if card_product.media[1].width >= 713 %}{{ card_product.media[1] | image_url: width: 713 }} 713w,{% endif %}
                    {% if card_product.media[1].width >= 823 %}{{ card_product.media[1] | image_url: width: 823 }} 823w,{% endif %}
                    {% if card_product.media[1].width >= 992 %}{{ card_product.media[1] | image_url: width: 992 }} 992w,{% endif %}
                    {{ card_product.media[1] | image_url }} {{ card_product.media[1].width }}w
                  '
                  src='{{ card_product.media[1] | image_url: width: 370 }}'
                  alt='{{ card_product.media[1].alt | escape }}'
                  sizes='(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 992px) calc((100vw - 130px) / 4), (min-width: 768px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)'
                  class='motion-reduce img-fluid mx-auto lazyload'
                  loading='lazy'
                  width='{{ card_product.media[1].width }}'
                  height='{{ card_product.media[1].height }}'
                >
              {%- endif -%}
            </a>
          </div>

          {%- liquid
            assign media_to_render = card_product.featured_media.id
            for variant in card_product.variants
              assign media_to_render = media_to_render | append: variant.featured_media.id | append: ' '
            endfor
          -%}
          {%- for media in card_product.media -%}
            {%- if media_to_render contains media.id
              and media.id != card_product.selected_or_first_available_variant.featured_media.id
            -%}
              <div class='product__media-item' data-media-id='{{ section.id }}-{{ card_product.id }}-{{ media.id }}'>
                <a
                  href='{{ card_product.url | append: '?variant=' | append: card_product.selected_or_first_available_variant.id | default: '#' }}'
                  title='{{ card_product.title | escape }}'
                  class='media media--transparent media--{{ media_size }} media--hover-effect'
                  {% if media_size == 'adapt' and card_product.featured_media %}
                    style='padding-bottom: {{ 1 | divided_by: featured_media_aspect_ratio | times: 100 }}%;'
                  {% endif %}
                >
                  <img
                    class='img-fluid mx-auto lazyload'
                    srcset='
                      {%- if media.preview_image.width >= 165 -%}{{ media.preview_image | image_url: width: 165 }} 165w,{%- endif -%}
                      {%- if media.preview_image.width >= 360 -%}{{ media.preview_image | image_url: width: 360 }} 360w,{%- endif -%}
                      {% if media.preview_image.width >= 493 %}{{ media.preview_image | image_url: width: 493 }} 493w,{% endif %}
                      {% if media.preview_image.width >= 600 %}{{ media.preview_image | image_url: width: 600 }} 600w,{% endif %}
                      {% if media.preview_image.width >= 713 %}{{ media.preview_image | image_url: width: 713 }} 713w,{% endif %}
                      {% if media.preview_image.width >= 823 %}{{ media.preview_image | image_url: width: 823 }} 823w,{% endif %}
                      {% if media.preview_image.width >= 992 %}{{ media.preview_image | image_url: width: 992 }} 992w,{% endif %}
                      {% if media.preview_image.width >= 1100 %}{{ media.preview_image | image_url: width: 1100 }} 1100w,{% endif %}
                      {% if media.preview_image.width >= 1206 %}{{ media.preview_image | image_url: width: 1206 }} 1206w,{% endif %}
                      {% if media.preview_image.width >= 1346 %}{{ media.preview_image | image_url: width: 1346 }} 1346w,{% endif %}
                      {% if media.preview_image.width >= 1426 %}{{ media.preview_image | image_url: width: 1426 }} 1426w,{% endif %}
                      {% if media.preview_image.width >= 1646 %}{{ media.preview_image | image_url: width: 1646 }} 1646w,{% endif %}
                      {% if media.preview_image.width >= 1946 %}{{ media.preview_image | image_url: width: 1946 }} 1946w,{% endif %}
                      {{ media.preview_image | image_url }} {{ media.preview_image.width }}w
                    '
                    src='{{ media.preview_image | image_url: width: 370 }} 370w'
                    sizes='(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 992px) calc((100vw - 130px) / 4), (min-width: 768px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)'
                    loading='lazy'
                    width='{{ media.preview_image.width }}'
                    height='{{ media.preview_image.height }}'
                    alt='{{ media.preview_image.alt | escape }}'
                  >
                  {%- if card_product.media[1] != null and show_secondary_image -%}
                    <img
                      srcset='
                        {%- if card_product.media[1].width >= 165 -%}{{ card_product.media[1] | image_url: width: 165 }} 165w,{%- endif -%}
                        {%- if card_product.media[1].width >= 360 -%}{{ card_product.media[1] | image_url: width: 360 }} 360w,{%- endif -%}
                        {% if card_product.media[1].width >= 493 %}{{ card_product.media[1] | image_url: width: 493 }} 493w,{% endif %}
                        {% if card_product.media[1].width >= 600 %}{{ card_product.media[1] | image_url: width: 600 }} 600w,{% endif %}
                        {% if card_product.media[1].width >= 713 %}{{ card_product.media[1] | image_url: width: 713 }} 713w,{% endif %}
                        {% if card_product.media[1].width >= 823 %}{{ card_product.media[1] | image_url: width: 823 }} 823w,{% endif %}
                        {% if card_product.media[1].width >= 992 %}{{ card_product.media[1] | image_url: width: 992 }} 992w,{% endif %}
                        {{ card_product.media[1] | image_url }} {{ card_product.media[1].width }}w
                      '
                      src='{{ card_product.media[1] | image_url: width: 370 }}'
                      alt='{{ card_product.media[1].alt | escape }}'
                      sizes='(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 992px) calc((100vw - 130px) / 4), (min-width: 768px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)'
                      class='motion-reduce img-fluid mx-auto lazyload'
                      loading='lazy'
                      width='{{ card_product.media[1].width }}'
                      height='{{ card_product.media[1].height }}'
                    >
                  {%- endif -%}
                </a>
              </div>
            {%- endif -%}
          {%- endfor -%}
        </div>
        {% comment %} Variants Wise Product Change Over {% endcomment %}
      {%- endif -%}

      {%- liquid
        if show_variants
          assign target = card_product.selected_or_first_available_variant
        else
          assign target = card_product
        endif
        assign compare_at_price = target.compare_at_price
        assign price = target.price | default: 1999
        if compare_at_price > price
          assign price_difference_percent = compare_at_price | minus: price | times: 100 | divided_by: compare_at_price | round
          if settings.currency_code_enabled
            assign price_difference_amount = compare_at_price | minus: price | money_with_currency
          else
            assign price_difference_amount = compare_at_price | minus: price | money
          endif
        endif
      -%}
      <div class='card__badge wb_badge_pos'>
        {% for tags in card_product.tags %}
          {% assign new_badge = tags | downcase %}
          {% if new_badge == 'new' %}
            <span class='badge new_product_badge'>{{- 'products.product.new' | t -}}</span>
          {% endif %}
        {% endfor %}

        {% if settings.sold_outp %}
          {%- if card_product.available == false -%}
            <span class='badge soldout_product_badge'>{{- 'products.product.sold_out' | t -}}</span>
          {%- endif -%}
          <span class='badge soldout_product_badge hidden'>{{- 'products.product.sold_out' | t -}}</span>
        {% endif %}

        {% if settings.percentage == true %}
          <span class='badge percent__badge-sale {% if price_difference_percent == null %}hidden{% endif %}'>
            {{ price_difference_percent -}}
            {{- 'products.product.off_price' | t }}
          </span>
        {% endif %}
        {% if settings.diff_price == true %}
          <span class='{% if settings.percentage == false %}save_top{% endif %} badge amount__badge-sale {% if price_difference_amount == null %}hidden{% endif %}'>
            {{- 'products.product.save' | t -}}
            {{ price_difference_amount }}
          </span>
        {%- endif -%}
      </div>

      {% if show_quick_view %}
        <div class='wbqvtop button-{{ section.id }}-show_desktop'>
          <button
            class='button focus-inset wbquickv quick_shop js-wbquickview-link {{ quick_v_pos }}'
            aria-label='{{ 'wbcustomlabel.wballtext.quickview' | t }}'
            variant-id='{{ card_product.selected_or_first_available_variant.id }}'
            data-url='{{ card_product.url }}'
          >
            {% if quick_icon == 'first-icon' %}
              {% render 'icon-quickview' -%}
              <span>{{ 'wbcustomlabel.wballtext.quickview' | t }}</span>
            {% else %}
              {% render 'icon-quickview2' -%}
              <span>{{ 'wbcustomlabel.wballtext.quickview' | t }}</span>
            {% endif %}
          </button>
        </div>
      {% endif %}
    </div>
    <div class='wbproductdes card__content'>
      {%- if show_vendor -%}
        <span class='visually-hidden'>{{ 'accessibility.vendor' | t }}</span>
        <div class='wbhomevendor'>{{ card_product.vendor }}</div>
      {%- endif -%}

      {% if display_product_type and card_product.type.size > 0 %}
        <p class='wbprotype'>{{ card_product.type }}</p>
      {% endif %}

      <h3 class='product-title'>
        <a href='{{ card_product.url | default: '#' }}'>{{ card_product.title | escape }}</a>
      </h3>

      {% comment %} TODO: metafield {% endcomment %}
      <span class='caption-large light'>{{ block.settings.description | escape }}</span>

      {%- if enable_listdesc and card_product.description != blank -%}
        <p class='wblistpdesc'>
          {{ card_product.description | strip_html | truncatewords: 26 }}
        </p>
      {%- endif -%}

      <div id='ProductInfo-{{ section.id }}-{{ card_product.id }}'>
        {%- assign product_form_id = 'product-form-' | append: section.id | append: '-' | append: card_product.id -%}

        <div
          class='no-js-hidden wbhprice'
          id='price-{{ section.id }}-{{ card_product.id }}'
          role='status'
          {{ block.shopify_attributes }}
        >
          {%- if show_quick_add or show_variants == false -%}
            {%- render 'price', product: card_product, use_variant: false, show_badges: false -%}
          {%- else -%}
            {%- render 'price', product: card_product, use_variant: true, show_badges: false -%}
          {%- endif -%}
        </div>

        {%- if show_rating -%}
          {%- if card_product.metafields.reviews.rating.value != blank -%}
            <div class='wbhrating'>
              {% liquid
                assign rating_decimal = 0
                assign decimal = card_product.metafields.reviews.rating.value.rating | modulo: 1
                if decimal >= 0.3 and decimal <= 0.7
                  assign rating_decimal = 0.5
                elsif decimal > 0.7
                  assign rating_decimal = 1
                endif
              %}
              <div
                class='rating'
                role='img'
                aria-label='{{ 'accessibility.star_reviews_info' | t: rating_value: card_product.metafields.reviews.rating.value, rating_max: card_product.metafields.reviews.rating.value.scale_max }}'
              >
                <span
                  aria-hidden='true'
                  class='rating-star'
                  style='--rating: {{ card_product.metafields.reviews.rating.value.rating | floor }}; --rating-max: {{ card_product.metafields.reviews.rating.value.scale_max }}; --rating-decimal: {{ rating_decimal }};'
                ></span>
              </div>
              <p class='rating-text caption'>
                <span aria-hidden='true'>
                  {{- card_product.metafields.reviews.rating.value }} /
                  {{ card_product.metafields.reviews.rating.value.scale_max -}}
                </span>
              </p>
              <p class='rating-count caption'>
                <span aria-hidden='true'>({{ card_product.metafields.reviews.rating_count }})</span>
                <span class='visually-hidden'>
                  {{- card_product.metafields.reviews.rating_count }}
                  {{ 'accessibility.total_reviews' | t -}}
                </span>
              </p>
            </div>
          {%- else -%}
            <div class='wbhrating'>
              <div class='rating'><span class='rating-star wbnorating'></span></div>
              <p class='rating-count caption'><span aria-hidden='true'>(0)</span></p>
            </div>
          {%- endif -%}
        {%- endif -%}

        {%- unless show_quick_add or card_product.has_only_default_variant -%}
          {%- if show_variants %}
            {%- if picker_type == 'button' -%}
              <variant-radios
                class='no-js-hidden new-swatch variant-webi'
                data-section='{{ section.id }}'
                data-product='{{ card_product.id }}'
                data-url='{{ card_product.url }}'
                data-update-url='false'
                data-layout='card'
                {{ block.shopify_attributes }}
              >
                {%- for option in card_product.options_with_values -%}
                  <fieldset
                    {% if option.name == 'Color' and show_colorswatch %}
                      class='swatchComponent inner-class'
                    {% else %}
                      class='js product-form__input inner-class'
                    {% endif %}
                  >
                    <div
                      {% if option.name == 'Color' and show_colorswatch %}
                        class='wbswatchclr'
                      {% endif %}
                    >
                      {%- for value in option.values -%}
                        <input
                          type='radio'
                          id='{{ section.id }}-{{ card_product.id }}-{{ option.position }}-{{ forloop.index0 }}'
                          name='{{ option.name }}'
                          value='{{ value | escape }}'
                          aria-label='Options'
                          form='{{ product_form_id }}'
                          {% if option.selected_value == value %}
                            checked
                          {% endif %}
                        >

                        {% if option.name == 'Color' and show_colorswatch %}
                          {%- liquid
                            assign color_file_name = value | handle | append: '.' | append: 'png'
                            assign swatchimage = color_file_name | file_img_url: '50x50' | prepend: 'https:' | split: '?' | first
                            assign colorswatchvalue = value | downcase | replace: ' ', ''
                          -%}
                          <label
                            class='color-swatchimg color-swatch {% if option.selected_value == value %} active{% endif %}'
                            for='{{ section.id }}-{{ card_product.id }}-{{ option.position }}-{{ forloop.index0 }}'
                            data-val='{{ value }}'
                            style='background-color: {{ colorswatchvalue }};{% if images[color_file_name] != blank %}  background-image: url({{ swatchimage }});{% endif %}'
                          ></label>
                        {% else %}
                          <label
                            class='color-swatch {% if option.selected_value == value %} active{% endif %}'
                            for='{{ section.id }}-{{ card_product.id }}-{{ option.position }}-{{ forloop.index0 }}'
                            data-val='{{ value }}'
                          >
                            {{- value -}}
                          </label>
                        {% endif %}
                      {% endfor %}
                    </div>
                  </fieldset>
                {% endfor -%}
                <script type='application/json'>
                  {{ card_product.variants | json }}
                </script>
              </variant-radios>
            {%- else -%}
              <variant-selects
                class='no-js-hidden'
                data-section='{{ section.id }}'
                data-product='{{ card_product.id }}'
                data-url='{{ card_product.url }}'
                data-update-url='false'
                data-layout='card'
                {{ block.shopify_attributes }}
              >
                {%- for option in card_product.options_with_values -%}
                  <div class='product-form__input product-form__input--dropdown'>
                    <label class='form__label' for='Option-{{ section.id }}-{{ card_product.id }}-{{ forloop.index0 }}'>
                      {{ option.name }}:
                    </label>
                    <div class='select'>
                      <select
                        id='Option-{{ section.id }}-{{ card_product.id }}-{{ forloop.index0 }}'
                        class='select__select'
                        name='options[{{ option.name | escape }}]'
                        form='{{ product_form_id }}'
                      >
                        {%- for value in option.values -%}
                          <option
                            data-val='{{ value }}'
                            value='{{ value | escape }}'
                            {% if option.selected_value == value %}
                              selected='selected'
                            {% endif %}
                          >
                            {{ value }}
                          </option>
                        {%- endfor -%}
                      </select>
                      {% render 'icon-caret' %}
                    </div>
                  </div>
                {%- endfor -%}
                <script type='application/json'>
                  {{ card_product.variants | json }}
                </script>
              </variant-selects>
            {%- endif -%}
          {%- endif -%}
        {%- endunless -%}

        <select
          name='id'
          id='Variants-{{ section.id }}-{{ card_product.id }}'
          class='select__select no-js'
          form='{{ product_form_id }}'
        >
          {%- for variant in card_product.variants -%}
            {%- liquid
              if variant.compare_at_price > variant.price
                assign price_difference_percent = variant.compare_at_price | minus: variant.price | times: 100 | divided_by: variant.compare_at_price | round
                assign price_difference_amount = variant.compare_at_price | minus: variant.price | money_with_currency
              endif
            -%}
            <option
              data-v-title='{{ variant.title }}'
              data-unitprice='{% if settings.currency_code_enabled %}{{ variant.unit_price | money_with_currency }}{% else %}{{ variant.unit_price | money }}{% endif %}'
              data-unitvalue='{% if variant.unit_price_measurement.reference_value != 1 %}{{ variant.unit_price_measurement.reference_value }}{% endif %}{{ variant.unit_price_measurement.reference_unit }}'
              data-price='{% if settings.currency_code_enabled %}{{ variant.price | money_with_currency }}{% else %}{{ variant.price | money }}{% endif %}'
              data-cprice='{% if settings.currency_code_enabled %}{{ variant.compare_at_price | money_with_currency }}{% else %}{{ variant.compare_at_price | money }}{% endif %}'
              data-percent='{% if settings.percentage == true and price_difference_percent != null %}{{ price_difference_percent }}{{ 'products.product.off_price' | t }}{% endif %}'
              data-damount='{% if settings.diff_price == true and price_difference_amount != null %}{{- 'products.product.save' | t -}} {{ price_difference_amount }}{% endif %}'
              {% if variant == card_product.selected_or_first_available_variant %}
                selected='selected'
              {% endif %}
              {% if variant.available == false %}
                disabled
              {% endif %}
              value='{{ variant.id }}'
            >
              {{ variant.title }}
              {%- if variant.available == false %} - {{ 'products.product.sold_out' | t }}{% endif %}
              - {{ variant.price | money | strip_html }}
            </option>
          {%- endfor -%}
        </select>

        <product-form class='product-form'>
          <div class='product-form__error-message-wrapper' role='alert' hidden>
            <svg aria-hidden='true' focusable='false' role='presentation' class='icon icon-error' viewBox='0 0 13 13'>
              <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"/>
              <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"/>
              <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"/>
              <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7"/>
            </svg>
            <span class='product-form__error-message'></span>
          </div>
          <div class='wbbtngrp'>
            {%- form 'product',
              card_product,
              id: product_form_id,
              class: 'form',
              novalidate: 'novalidate',
              data-type: 'add-to-cart-form'
            -%}
              <input type='hidden' name='id' value='{{ card_product.selected_or_first_available_variant.id }}' disabled>
              <button
                type='submit'
                name='add'
                class='{% if button_style == 'link' %}link underlined-link{% elsif button_style == 'solid' %}button button--primary cartb{% else %}button button--secondary cartb{% endif %} focus-inset product-form__submit cartmobile'
                aria-label='{{ 'products.product.add_to_cart' | t }}'
                {% if card_product.selected_or_first_available_variant.available == false %}
                  disabled
                {% endif %}
              >
                {%- if card_product.selected_or_first_available_variant.available -%}
                  {% render 'icon-pcart' -%}
                  <span>{{ 'products.product.add_to_cart' | t }}</span>
                {%- else -%}
                  {% render 'icon-pcart' -%}
                  <span>{{ 'products.product.sold_out' | t }}</span>
                {%- endif -%}
                <div class='loading-overlay__spinner hidden'>
                  <svg
                    aria-hidden='true'
                    focusable='false'
                    role='presentation'
                    class='spinner'
                    viewBox='0 0 66 66'
                    xmlns='http://www.w3.org/2000/svg'
                  >
                    <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                  </svg>
                </div>
              </button>
            {%- endform -%}
            {% if show_quick_view %}
              <div class='wbqvtop button-{{ section.id }}-show_mobile'>
                <button
                  class='button focus-inset wbquickv quick_shop js-wbquickview-link'
                  aria-label='{{ 'wbcustomlabel.wballtext.quickview' | t }}'
                  data-id='{{ card_product.id }}'
                  variant-id='{{ card_product.selected_or_first_available_variant.id }}'
                  data-url='{{ card_product.url }}'
                >
                  {% if quick_icon == 'first-icon' %}
                    {% render 'icon-quickview' -%}
                    <span>{{ 'wbcustomlabel.wballtext.quickview' | t }}</span>
                  {% else %}
                    {% render 'icon-quickview2' -%}
                    <span>{{ 'wbcustomlabel.wballtext.quickview' | t }}</span>
                  {% endif %}
                </button>
              </div>
            {% endif %}
          </div>
        </product-form>
      </div>
    </div>
  </div>
</div>
